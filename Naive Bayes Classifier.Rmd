---
title: "Naive Bayes Classifier for Titanic Dataset"
author: "Lab3"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
  word_document: default
---
### To install the package
```{r}
#install.packages("e1071")   # Install e1071 package
library(e1071) # For Naive Bayes
library(dplyr) # For data manipulation

```
### To load the data of Titanic 

```{r}
# Load your Titanic dataset 
titanic_data <- read.csv("D:\\sandip sir 3rd sem lab\\titanic_dataset.csv")

# View the first few rows of the dataset
head(titanic_data)
```
### Now data preprocessing before the training the data
### Here first deal with convert categorical variable to factors
```{r}
str(titanic_data)

```


```{r}
colnames(titanic_data)
```



```{r}
# Open a spreadsheet-like view of the data
#View(titanic_data)
```


```{r}
# Convert 'Survived', 'Sex', and 'Pclass' etc to factors
titanic_data$Survived <- as.factor(titanic_data$survived)
titanic_data$Sex <- as.factor(titanic_data$sex)
titanic_data$embarked <- as.factor(titanic_data$embarked)
titanic_data$class <- as.factor(titanic_data$class)
titanic_data$who <- as.factor(titanic_data$who)
titanic_data$embark_town <- as.factor(titanic_data$embark_town)
titanic_data$alive <- as.factor(titanic_data$alive)
titanic_data$alone <- as.factor(titanic_data$alone)
```

```{r}
str(titanic_data)
# View levels of some factors
levels(titanic_data$sex)
levels(titanic_data$pclass)
```


### To Handle the missing value


```{r}
# Check for NA values
sum(is.na(titanic_data))     # for count the total sum of missing value
colSums(is.na(titanic_data)) # for count for each column
```
### here is the missing value in the only age i.e.177
### Then fill the missing value by its means value
```{r}
library(dplyr)
titanic_data <- titanic_data %>%
    mutate( age = ifelse(is.na( age), mean( age, na.rm = TRUE),  age))
```



### Visualizing Missing data

```{r}
#install.packages("visdat")
library(visdat)
vis_miss(titanic_data)  # Visualize missing values
```

```{r}
sum(is.na(titanic_data))
```

### there is no any missing value present in the dataset
### Now select the feature that is relevent for modeling

```{r}
# Select relevant features for modeling
titanic_model_data <- titanic_data %>%
    select(survived, pclass,sex,age, fare,sibsp,embarked)

# Adjust features as necessary
# View cleaned data
head(titanic_model_data)
```
### Split the Data into Traing and Testing sets

```{r}

set.seed(123)  # For reproducibility
train_indices <- sample(1:nrow(titanic_model_data), size = 0.8 * nrow(titanic_model_data))
train_data <- titanic_model_data[train_indices, ]
test_data <- titanic_model_data[-train_indices, ]

```

### Train the Naive Bayes Model
```{r}
# Train the NaÃ¯ve Bayes model
naive_bayes_model <- naiveBayes(survived ~ ., data = train_data)

# Print model summary
print(naive_bayes_model)
```
### Make Prediction
```{r}
# Make predictions on test data
predictions <- predict(naive_bayes_model, newdata = test_data)

# View predictions
head(predictions)
```
### Model Evaluation
```{r}
# Create a confusion matrix
confusion_matrix <- table(test_data$survived, predictions)

# Print confusion matrix
print(confusion_matrix)

# Calculate accuracy
accuracy <- sum(diag(confusion_matrix)) / sum(confusion_matrix)
cat("Accuracy:", accuracy * 100, "%\n")
```
Accuracy is 77.65363% reliable performance.






















